<%@ page contentType="text/html; charset=GBK"%>
<%@ include file="/IncludeBegin.jsp"%>
<%
	//文档编号
	String sDocNo = DataConvert.toRealString(iPostChange,(String)CurComp.getParameter("DocNo"));

    if(sDocNo == null) sDocNo = "";

%>
<html>
<head> 
<title>请输入附件信息</title>
<script type="text/javascript">
	function checkItems(){
		var o = document.forms["SelectAttachment"];
		var sFileName = o.AttachmentFileName.value;
		
		var sModelID = o.ModelID.value;
		var sRuleType = o.RuleType.value;
		var sRuleID = o.RuleID.value;
		var sVersionID = o.VersionID.value;

		o.FileName.value=sFileName;
		
		if(typeof(sModelID) == "undefined" || sModelID==""){
			alert("请输入规则模型!");
			return false;
		}
		
		if(typeof(sRuleType) == "undefined" || sRuleType==""){
			alert("请输入规则类型!");
			return false;
		}
		
		if(typeof(sRuleID) == "undefined" || sRuleID==""){
			alert("请输入规则编号!");
			return false;
		}
		
		if(typeof(sVersionID) == "undefined" || sVersionID==""){
			alert("请输入版本编号!");
			return false;
		}
		
		if (typeof(sFileName) == "undefined" || sFileName==""){
			alert("请选择一个文件名!");
			return false;
		}
		
		//判断是否是.ZIP结尾的
		var str=sFileName.split(".");
		var ss=str[1];
		if(ss !="zip"){
			alert("文件必须是以.zip结尾！");
			return false;
		}
		
		return true;
	}

</script>

<style>
.black9pt {  font-size: 9pt; color: #000000; text-decoration: none}
</style>
</head>
<body bgcolor="#D3D3D3">
<form name="SelectAttachment" method="post" ENCTYPE="multipart/form-data" action="<%=sWebRootPath%>/AppConfig/Document/AttachmentUpload.jsp?CompClientID=<%=CurComp.getClientID()%>" align="center">

<table align="center">
	<tr>
		<td class="black9pt"  align="left">规则模型：&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="ModelID"></td>
	</tr>
	<tr>
		<td class="black9pt"  align="left">规则类型：&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="RuleType"></td>
	</tr>
	<tr>
		<td class="black9pt"  align="left">规则编号：&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="RuleID"></td>
	</tr>
	<tr>
		<td class="black9pt"  align="left">版本编号：&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="VersionID"></td>
	</tr>
	<tr>
		<td class="black9pt"  align="left"></td>
	</tr>
	<tr>
    		<td class="black9pt"  align="left">
    			<font size="2">请选择一个文件作为附件上传:</font>
    		</td> 
    	</tr>
    	<tr>
    		<td>   
    			<input type="file" size=60  name="AttachmentFileName"> 
    		</td>
    	</tr>
      	<tr>
      		<td>
      			&nbsp;&nbsp;
    			<input type=hidden name="CompClientID" value="<%=CurComp.getClientID()%>" >
    			<input type=hidden name="DocNo" value="<%=sDocNo%>" >
    			<input type=hidden name="FileName" value="" >
    		</td> 
    	</tr>
    	<tr>
      		<td>
      			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="button" style="width:50px"  name="ok" value="确认" onclick="javascript:if(checkItems()) { SelectAttachment.submit();} ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="button" style="width:50px"  name="Cancel" value="取消" onclick="javascript:self.returnValue='_none_';self.close()">
		</td>
	</tr>
 </table>
</form>
</body>
</html>
<%@ include file="/IncludeEnd.jsp"%>