<%@ page contentType="text/html; charset=GBK"%>
<%@ include file="/IncludeBegin.jsp"%>

<%/*~BEGIN~可编辑区~[Editable=true;CodeAreaID=List00;Describe=注释区;]~*/%>
	<%
	/*
		Describe: 合同费用减免信息页面
	 */
	%>
<%/*~END~*/%>

<%/*~BEGIN~可编辑区~[Editable=true;CodeAreaID=Info01;Describe=定义页面属性;]~*/%>
	<%
	String PG_TITLE = "合同费用减免信息页面"; // 浏览器窗口标题 <title> PG_TITLE </title>
	//获得组件参数
    String sObjectType = DataConvert.toRealString(iPostChange,(String)CurComp.getParameter("ObjectType"));
    String sLoanSerialNo = DataConvert.toRealString(iPostChange,(String)CurComp.getParameter("ObjectNo"));
    if(sLoanSerialNo == null ) sLoanSerialNo = "";
    if(sObjectType == null ) sObjectType = "";

	%>
<%/*~END~*/%>

<%/*~BEGIN~可编辑区~[Editable=true;CodeAreaID=Info03;Describe=定义数据对象;]~*/%>
	<%
		String sHeaders[][] = { 
								{"FeeType","费用类型"},
								{"WaiveFromStage","减免开始期次"},
								{"WaiveToStage","减免到期期次"},
								{"Status","状态"}
								
								}; 

		 String sSql ="SELECT costreductiontype as FeeType,WaiveFromStage as WaiveFromStage,WaiveToStage as WaiveToStage,Status as Status "+
				      "from acct_fee_waive where objectno in (select serialno from acct_fee where objectno='"+sLoanSerialNo+"') ";

	 //设置DataObject				
	 ASDataObject doTemp = new ASDataObject(sSql);
	
	 doTemp.setHeader(sHeaders);
	 doTemp.setDDDWCode("FeeType", "AcctFeeType");
	 doTemp.setDDDWCode("Status", "FeeStatus");
	 doTemp.setColumnType("WaiveFromStage,WaiveToStage", "2");
	 doTemp.setHTMLStyle("FeeType","style={width:150px}");
	 doTemp.setHTMLStyle("WaiveFromStage,WaiveToStage","style={width:30px}");
	 
	 ASDataWindow dwTemp = new ASDataWindow(CurPage,doTemp,Sqlca);
	 //dwTemp.setPageSize(24);//设置分页
	 dwTemp.Style="1";      //设置DW风格 1:Grid 2:Freeform
	 dwTemp.ReadOnly = "1"; //设置为可写
	 dwTemp.ShowSummary = "1";//设置汇总
	//生成datawindow
	Vector vTemp = dwTemp.genHTMLDataWindow("");
	for(int i=0;i<vTemp.size();i++) out.print((String)vTemp.get(i));
		

	%>
<%/*~END~*/%>

<%/*~BEGIN~可编辑区~[Editable=true;CodeAreaID=Info04;Describe=定义按钮;]~*/%>
	<%
	//依次为：
		//0.是否显示
		//1.注册目标组件号(为空则自动取当前组件)
		//2.类型(Button/ButtonWithNoAction/HyperLinkText/TreeviewItem/PlainText/Blank)
		//3.按钮文字
		//4.说明文字
		//5.事件
		//6.资源图片路径
		String sButtons[][] = {
		{"true","","Button","导出Excel","导出Excel","exportAll()",sResourcesPath}
		};
	
	%> 
<%/*~END~*/%>
	
<%/*~BEGIN~不可编辑区~[Editable=false;CodeAreaID=Info05;Describe=主体页面;]~*/%>
	<%@include file="/Resources/CodeParts/Info05.jsp"%>
<%/*~END~*/%>

<%/*~BEGIN~可编辑区~[Editable=false;CodeAreaID=Info06;Describe=定义按钮事件;]~*/%>
	<script type="text/javascript">
	 /*~[Describe=导出;InputParam=无;OutPutParam=无;]~*/
	function exportAll()
	{
		amarExport("myiframe0");
	}
	
	</script>
<%/*~END~*/%>

<%/*~BEGIN~可编辑区~[Editable=false;CodeAreaID=Info08;Describe=页面装载时，进行初始化;]~*/%>
<script type="text/javascript">	
	AsOne.AsInit();
	init();
	my_load(2,0,'myiframe0');
</script>	
<%/*~END~*/%>

<%@ include file="/IncludeEnd.jsp"%>
